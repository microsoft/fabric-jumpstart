name: Gated Check In - Full

on:
  pull_request:
  workflow_dispatch:

jobs:
  gci-linux:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash

    steps:
      - name: "ğŸ”„ Checkout"
        uses: actions/checkout@v4

      - name: "âš™ï¸ Bootstrap CI Environment"
        run: contrib/bootstrap-ci.sh

      - name: "ğŸ§¹ Clean Projects"
        run: npx nx run-many -t clean --parallel=3 --output-style=stream

      - name: "ğŸ“¦ Build Projects"
        run: npx nx run-many -t build --parallel=3 --output-style=stream

      - name: "ğŸ§ª Test Projects"
        run: npx nx run-many -t test --verbose --output-style=stream

      - name: "ğŸ“ Verify No Untracked Files"
        run: npm run fail-on-untracked-files
